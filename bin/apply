#!/bin/sh
PYTHON_VERSION="3.12.1"
PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"

# Check if pyenv is available
if command -v pyenv 1>/dev/null 2>&1; then
    eval "$(pyenv init -)"
fi

if pyenv versions --bare | grep -q "$PYTHON_VERSION"; then
    echo "Python $PYTHON_VERSION to be used."
else
    echo "Python $PYTHON_VERSION is not installed. Installing..."
    pyenv install "$PYTHON_VERSION"
fi

pyenv shell $PYTHON_VERSION

ansible-playbook -i "localhost," -c local main.yml --ask-become-pass -v
exec "$SHELL"
